/* 히스토그램*/
proc sgplot data=sashelp.iris;
  where Species in ("Setosa", "Versicolor");       /* restrict to two groups */
  histogram SepalLength / group=Species transparency=0.5;       /* SAS 9.4m2 */
  density SepalLength / type=kernel group=Species; /* overlay density estimates */
run;

title "PROC SGPANEL with PANELBY statement";
proc sgpanel data=sashelp.iris;
  panelby Species / rows=3 layout=rowlattice;
  histogram SepalLength;
run;


title 'Comparative plots';
proc univariate data=sashelp.iris noprint;
class Species;
var SepalLength;
histogram SepalLength / vscale=count normal(noprint);
inset normal(mu sigma);
run;

/*ods select Comparative plots;*/
PROC CAPABILITY DATA = sashelp.iris OUTTABLE= aa noprint 
		CIBASIC(TYPE=TWOSIDED ALPHA=0.05)
		MU0=0 

;
	VAR SepalLength ;
	/*
	SPEC USL=	-19	 WUSL=2 LUSL=4 	CUSL=RED 
 	CRIGHT=YELLOW;*/
	HISTOGRAM  SepalLength / NORMAL 	( 	W=1 	L=1 	COLOR=BLACK  MU=EST SIGMA=EST noprint ) 
	CAXIS=PURPLE
	CTEXT=BLACK
	CFRAME=WHITE
	CBARLINE=BLACK
	CFILL=GRAY

;
class  Species  ;
RUN; 


	/* BATCH MACRO LOOP */
	%DO j=1 %TO %EVAL(&l_work_cnt)  %BY 1 ;
        DATA CAPABILITY_CHART(KEEP=&&l_log_var_&j..2 RENAME=(&&l_log_var_&j..2=&&l_log_var_&j.. )) ;
        LENGTH &&l_log_var_&j..2 8. ;
        SET  &&l_log_fnm_&j.. ;
        &&l_log_var_&j..2 = &&l_log_var_&j..;
        RUN;


        title ;
        ods layout gridded columns=2  ;
        ods region;
        title &&l_blog_id_&j..;
        PROC CAPABILITY DATA = CAPABILITY_CHART noprint /*outtable=aa*/
        ;
            SPEC usl = &&PRO_LCBVER_&j._min. ;
           	COMPHIST  &&l_log_var_&j.. / 	
            NORMAL(noprint) 
           /* midpoints=0.2 to 1.8 by 0.2*/
           /* NMIDPOINTS = 100 */
              ;
            inset normal(mu sigma) min max n /  pos = ne format = 7.2;
            inset  usl='상한SPEC' uslpct / cfill=ywh cshadow=dagr;
          /*inset mean std="Std Dev" / pos = ne format = 6.3;*/
        RUN; QUIT;


        title ;
        ods region;
        title &&l_blog_id_&j..;
        PROC CAPABILITY DATA = CAPABILITY_CHART noprint outtable=aa
        ;
            SPEC usl = &&PRO_LCBVER_&j._max ;
           	COMPHIST  &&l_log_var_&j.. / 	
            NORMAL(noprint) 
           /* midpoints=0.2 to 1.8 by 0.2*/
           /* NMIDPOINTS = 100 */
              ;
            inset normal(mu sigma) min max n /  pos = ne format = 7.2;
            inset  usl='수정SPEC' uslpct / cfill=ywh cshadow=dagr;
          /*inset mean std="Std Dev" / pos = ne format = 6.3;*/
        RUN; QUIT;
        ods layout end;

	%END;
	
PROC CAPABILITY DATA = aa(WHERE=(CASE_TYPE IN ("2","3"))) noprint OUTTABLE=SPEC_01;
    SPEC lsl = &PRO_INPUT_SPEC. ;
    COMPHIST g1  / 	
    NORMAL(noprint) ;
    inset normal(mu sigma) min max n /  pos = ne;
    inset  lsl='하한SPEC' lslpct / cfill=ywh cshadow=dagr;
RUN;	

/*boxplot+line */
ods graphics on  / imagemap;
*ods graphics off;
PROC SGPLOT DATA=WORK.abc;
    title "CC_A_RG_ERROR Boxplot";
    vbox CCR / category=NAME_CUST  ;
    series x=NAME_CUST y=UCL / y2axis lineattrs=(color=red thickness=1px)  ;
    series x=NAME_CUST y=LCL / y2axis lineattrs=(color=green thickness=1px)  ;
    yaxis MAX= &BOXPLOT_MAX MIN=&BOXPLOT_MIN;
    y2axis MAX= &BOXPLOT_MAX MIN= &BOXPLOT_MIN;
    BY MODEL NAME_CUST SN  ;
RUN;
ods _all_ close;


/*ods graphics on / imagemap width=10in height=5in;*/
